<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NearME</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
    rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="../Style/Main.css">
    <link rel="stylesheet" href="../Style/Services.css">
    <link rel="stylesheet" href="../Style/swiper-bundle.min.css">
    <link rel="stylesheet" href="../Style/HomeResponsive.css">
    <style>
       /* Loader Wrapper */
    #loader-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1034;
      background-color: transparent;
      visibility: visible;
      transition: all 2s 4s ease-out;
    }

    /* Loader */
    #loader {
      display: block;
      position: relative;
      left: 50%;
      top: 50%;
      width: 150px;
      height: 150px;
      margin: -75px 0 0 -75px;
      border-radius: 50%;
      border: 3px solid transparent;
      border-top-color: #06b2fa;
      animation: spin 1s linear infinite;
      z-index: 1034;
    }

    #loader:before,
    #loader:after {
      content: "";
      position: absolute;
      border-radius: 50%;
      border: 3px solid transparent;
    }

    #loader:before {
      top: 5px;
      left: 5px;
      right: 5px;
      bottom: 5px;
      border-top-color: #fff;
      animation: spin 2s linear infinite;
    }

    #loader:after {
      top: 15px;
      left: 15px;
      right: 15px;
      bottom: 15px;
      border-top-color: #0897f3;
      animation: spin 1.5s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    /* Loader Sections */
    .loader-section {
      position: fixed;
      top: 0;
      width: 50%;
      height: 100%;
      background: transparent;
      z-index: 1032;
      transition: all 0.7s 0.7s cubic-bezier(0.645, 0.045, 0.355, 1);
    }

    .loader-section.section-left {
      left: 0;
    }

    .loader-section.section-right {
      right: 0;
    }

    /* Loader Wrapper Transition on Loaded */
    .loaded #loader-wrapper {
      visibility: hidden;
      transform: translateY(-100%);
      transition: all 1s 0.7s ease-out;
    }

    /* Loader Transition on Loaded */
    .loaded #loader {
      opacity: 0;
      transition: all 1s ease-out;
    }

    /* Loader Sections Transition on Loaded */
    .loaded .loader-section.section-left {
      transform: translateX(-100%);
    }

    .loaded .loader-section.section-right {
      transform: translateX(100%);
    }
    </style>      
</head>
<body>
  <main> 
 

  <!-- Screen lazy loding  -->
  <div id="loader-wrapper">
		<div id="loader"></div>
		<div class="loader-section section-left"></div>
		<div class="loader-section section-right"></div>
	</div>

  <script>
      // Screen Loader
      document.addEventListener('DOMContentLoaded', function() {
        document.body.classList.add('loaded');
      });  
  </script>


 <!-- navbar -->
      <%- include('partials/DriverHeader.ejs',{user:user}); -%>

    <div class="backgroundTop">
      <img class="imgtop" src="../Assets/backgrounds/mechanical-engineer-technician-car-inspecting-769ahdnuovbgb7yf.jpg" alt="Auto Repair background">
      <div class="blackbackground"></div>
    </div>
    <section class="sectionposition">
        <h1 class="underline">________________</h1> 
        <h1 class="W-size">Welcome To NearMe</h1>
        <h1 class="Q-size">QUALITY SERVICES</h1>
        <h1 class="S-size">CAR REPAIR SERVICES ON THE ROAD</h1>
        <%# Request Service Button %>
        <% if (!flage) { %>
          <div class="RQ-btn-form">
            <a href="/Driver/RequestService" class="RQ-btn">Request Service Now!</a>
          </div>
        <%# Request Service Button %>
        <% } else if(flage){ %>
          <div class="RQ-btn-form1">
            <a href="/Driver/YourRequest" class="RQ-btn1">Back to your Request?<br>
              <h8 class="asdfasdf"> Check on your request...</h8></a>
          </div>
          <% } %>
    </section>

    <!-- Service cards -->
  
<section id="Services" class="services-body">
  <div class="slide-container swiper">
   <div class="ttt"><h2 class="name1">NearMe Services</h2></div>
    <div class="slide-content">
      <div class="card-wrapper swiper-wrapper">
       <div class="card swiper-slide">
           <div class="image-content ">
               <span class="overlay1">

               </span>
               <div class="card-image">
                   <img src="../Assets/services-pictures/new/towtruck.png" alt="" class="card-img">
               </div>
           </div>
           <div class="card-content">
               <h2 class="name">Towing Truck</h2>
               <br>
               <p class="description">Wherever you are we are with you, in simple steps and in less than one minute you can request 
                   car tow (from-to) any direction upon your wish inside AMMAN with the best and lowest price ever:
                   <ul>
                     <li class="description" id="content1"><b>15-20JOD</b> morning period.</li>
                     <li class="description" id="content2"><b>25-30JOD</b> evening period.</li>
                   </ul>
                   </p>
           </div>
       </div>
       <div class="card swiper-slide">
           <div class="image-content swiper-wrapper">
               <span class="overlay1">

               </span>
               <div class="card-image">
                   <img src="../Assets/services-pictures/new/changetire.jpg" alt="" class="card-img">
               </div>
           </div>
           <div class="card-content">
               <h2 class="name">Flat tire</h2><br>
               <p class="description">How many times have you left your home and found
                   your car flat tire needs to change in a hot or cold weather,
                   or you will be late on your work,
                   donâ€™t worry we are to help you, request change flat tire through NearMe
                    application and we will serve you.
                   </p>
           </div>
       </div>
       <div class="card swiper-slide">
           <div class="image-content swiper-wrapper">
               <span class="overlay1">

               </span>
               <div class="card-image">
                   <img src="../Assets/services-pictures/new/changeoil.jpg" alt="" class="card-img">
               </div>
           </div>
           <div class="card-content">
               <h2 class="name">Change oil</h2><br>
               <p class="description">ou can now change your car engine oil and filters,
                   just select your location through NearME application and ask for oil change service,
                    we will serve you in a short period of time and you can also make an appointment
                     for your suitable time.
                   We will guide you to assure that your car engine at the best performance.           
                   </p>
           </div>
       </div>
       <div class="card swiper-slide">
           <div class="image-content swiper-wrapper">
               <span class="overlay1">

               </span>
               <div class="card-image">
                   <img src="../Assets/services-pictures/new/changebattery.jpg" alt="" class="card-img">
               </div>
           </div>
           <div class="card-content">
               <h2 class="name">Change & replace battery</h2><br>
               <p class="description">All you have to do is choose the battery services icon,
                   provide your car model and date of manufacture, and we will change
                    the car battery in the location you previously specified, you can
                     also request jump start service only or recharge
                   electric car battery to get you to the nearest power
                    supply provider.
                   </p>
           </div>
       </div>
       <div class="card swiper-slide">
           <div class="image-content swiper-wrapper">
               <span class="overlay1">

               </span>
               <div class="card-image">
                   <img src="../Assets/services-pictures/new/man-wearing-gloves-holding-wrench.jpg" alt="" class="card-img">
               </div>
           </div>
           <div class="card-content">
               <h2 class="name">Under hood service</h2><br>
               <p class="description">we provide many services that will help under hood problem such as:
                   <ul>
                   <li class="description">Air Filter Blower Motor Replacement.</li>
                   <li class="description">Air Conditioner Filter Replacement.</li>
                   <li class="description">General maintenance.</li>
                   </ul>
                   </p>
           </div>
       </div>
   </div>
</div>
<div class="swiper-button-next swiper-navBtn "></div>
<div class="swiper-button-prev swiper-navBtn"></div>
<div class="swiper-pagination"></div>
</div>
</section>

<!-- Accept button -->
<% if (pending) { %>
  <div id="ConfirmModle" class="modal" style="display: block;">
      <div class="modal-content">
        <form id="confirmationForm" method="post" action="/Driver/CancelTechnician">
          <h4>The technician is ready for you. Would you prefer to review his information or decline the service?</h4>
          <div id="modalData"></div>
          <div class="Button_center">
            <button id="ConfirmModleyes" class="modal-button yes" onclick="handleYes()" type="button">Yes</button>
            <button id="ConfirmModleno"  class="modal-button no"  onclick="handleNo()" type="button">No</button>
          </div>
        </form>
      </div>
  </div> 
<% } %>



<input type="hidden" name="user" id="userdata" value="<%= JSON.stringify(user,null,2) %>">
<input type="hidden" name="suc" id="success" value="<%= suc %>">
<input type="hidden" name="suc" id="error" value="<%= er %>">

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/socket.io/socket.io.js"></script>
    <script>

//New Toast Notification
    const success  = document.getElementById("success").value;
    const error  = document.getElementById("error").value;
  if(typeof success !== 'undefined' && success !== null && success !== ''){
    let timerInterval;
    Swal.fire({
    icon: "success",
    title: success,
    position: "top",
    timer: 2000,
    timerProgressBar: true,
    didOpen: () => {
      Swal.showLoading();
    },
    willClose: () => {
      clearInterval(timerInterval);
    }
  }).then((result) => {
    /* Read more about handling dismissals below */
    if (result.dismiss === Swal.DismissReason.timer) {
      console.log("I was closed by the timer");
    }
  });
}


if(typeof error !== 'undefined' && error !== null && error !== ''){
    let timerInterval;
    Swal.fire({
    icon: "error",
    title: error,
    position: "top",
    timer: 2000,
    timerProgressBar: true,
    didOpen: () => {
      Swal.showLoading();
      const timer = Swal.getPopup().querySelector("b");
      timerInterval = setInterval(() => {
        timer.textContent = `${Swal.getTimerLeft()}`;
      }, 100);
    },
    willClose: () => {
      clearInterval(timerInterval);
    }
  }).then((result) => {
    /* Read more about handling dismissals below */
    if (result.dismiss === Swal.DismissReason.timer) {
      console.log("I was closed by the timer");
    }
  });
}

  // Get the JSON string from the userdata element
    const userdataValue = document.getElementById("userdata").value;
    const userArray=JSON.parse(userdataValue);
      var socket = io();
      socket.on(`on-updates-${userArray.user_id}`, (message) => {
        alert(message);
      });
      socket.on(`accepet-decline-${userArray.user_id}`, (data)=>{
        window.location.href = '/Driver/Home';
        //showConfirmModal(data);
      });
      socket.on(`service-completed-${userArray.user_id}`, (message) => {
        window.location.href = '/Driver/Feedback';
      });
      socket.on('connect', () => {
          console.log('connected to server');
      });

      

      socket.on('disconnect', () => {
          console.log('disconnected from server');
      });

      function showConfirmModal(data) {
      const modalDataDiv = document.getElementById('modalData');
      modalDataDiv.innerHTML = `
          <p>Technician Name: ${data.workshop.username}</p>
          <p>Price: ${data.price}</p>
      `;
      document.getElementById('ConfirmModle').style.display = "block";
    }
     // toast notification PopUp
     function handleYes() {
        // Change the form action to /Driver/Accept
        document.getElementById("confirmationForm").method="get";
        document.getElementById("confirmationForm").action = "/Driver/YourRequest";

        // Submit the form
        document.getElementById("confirmationForm").submit();
      }

      function handleNo() {
        // Change the form action to /Driver/CancelTechnician
        document.getElementById("confirmationForm").action = "/Driver/CancelTechnician";

        // Submit the form
        document.getElementById("confirmationForm").submit();
      }

    // toast notification PopUp
        document.addEventListener('DOMContentLoaded', function () {
        const toastElement = document.querySelector('.toast-center1');
        const closeButton = toastElement.querySelector('.btn-close'); 
        closeButton.addEventListener('click', function () {
        toastElement.classList.remove('slide-in'); 
        toastElement.classList.add('slide-out');
        setTimeout(function () {
          showToast();
            toastElement.classList.remove('show', '.toast-center1.slide-in');
        }, 500);
    }); 
    function showToast() {
        toastElement.classList.add('show', '.toast-center1.slide-in'); 
    }
    
    });
       
        document.addEventListener('DOMContentLoaded', function () {
        const toastElement = document.querySelector('.toast-center');
        const closeButton = toastElement.querySelector('.btn-close'); 
        closeButton.addEventListener('click', function () {
        toastElement.classList.remove('slide-in'); 
        toastElement.classList.add('slide-out');
        setTimeout(function () {
            toastElement.classList.remove('show', '.toast-center.slide-in');
        }, 500);
    }); 
    function showToast() {
        toastElement.classList.add('show', '.toast-center.slide-in'); 
    }
    showToast();
});
       


        //sidebar
        function showSidebar(){
          const sidebar = document.querySelector('.sidebar')
          sidebar.style.display = 'flex'
        }
        function hideSidebar(){
          const sidebar = document.querySelector('.sidebar')
          sidebar.style.display = 'none'
        }


        document.addEventListener('scroll', () => {
          const nav =document.querySelector('nav');
          const logo =document.querySelector('.logo-transparent')
          
          if(window.scrollY > 1){
            nav.classList.add('scrolled');
            logo.classList.add('scrolled');
          } else {
            nav.classList.remove('scrolled');
            logo.classList.remove('scrolled');
          }
        });
        document.querySelectorAll('.card').forEach(item =>{
            item.onmousemove = e =>{
                item.style.setProperty('--x' , (e.pageX -
                item.offsetLeft) + 'px');
                item.style.setProperty('--y' , (e.pageY -
                item.offsetTop) + 'px');
            };
        });



    function toggleDropdown() {
      var dropdown = document.getElementById("dropdownContent");
      dropdown.style.display === "none" ? dropdown.style.display = "block" : dropdown.style.display = "none";
    }

    document.addEventListener("click", function(event) {
     var dropdown = document.getElementById("dropdownContent");
     var profilePicture = document.querySelector(".profile-picture");
      if (!profilePicture.contains(event.target) && !dropdown.contains(event.target)) {
           dropdown.style.display = "none";
    }
    });

    function toggleDropdown1() {
      var dropdown = document.getElementById("dropdownContent1");
      dropdown.style.display === "none" ? dropdown.style.display = "block" : dropdown.style.display = "none";
    }

    document.addEventListener("click", function(event) {
     var dropdown = document.getElementById("dropdownContent1");
     var profilePicture = document.querySelector(".profile-picture1");
      if (!profilePicture.contains(event.target) && !dropdown.contains(event.target)) {
           dropdown.style.display = "none";
    }
    });
    </script>
    <script src="../Style/swiper-bundle.min.js"></script>
    <script src="../Style/Services-script.js"></script>
    
    <%- include('partials/footer.ejs'); -%>